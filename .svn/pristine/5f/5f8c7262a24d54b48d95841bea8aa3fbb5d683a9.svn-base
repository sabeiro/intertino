#!/usr/bin/env Rscript
setwd('C:/Users/giovanni.marelli.PUBMI2/lav/media/')
source('script/graphEnv.R')
require('forecast')
library(splines)


fs <- read.csv('raw/telCherry.csv')
fs$Date <- as.Date(fs$Date,format="%d/%m/%Y")
fs <- fs[grepl("Canale 5",fs$Channel),]

fs1 <- read.csv('raw/inventoryVideo2016.csv')
fs1 <- fs1[grepl("cherry_",fs1$Section),]
fs1$Data <-  as.Date(fs1$Data)

ws <- fs[,colnames(fs) %in% c("Date","Total.Individuals")]
ws1 <- fs1[,colnames(fs1) %in% c("Data","Imps")]
ws1 <- ddply(ws1,.(Data),summarise,Imps=sum(Imps,na.rm=T))
ws <- merge(ws,ws1,by.x="Date",by.y="Data",all=T)
colnames(ws) <- c("Date","tv","web")
tvWeb <- sum(ws$web,na.rm=T)/sum(ws$tv,na.rm=T)

ws$tv <- ws$tv/1000000
ws$web <- ws$web/1000000

gLabel = c("data","impression (M)",paste("evoluzione tv/web cherry season"),"-")
ggplot(ws,aes(x=Date)) +
    geom_bar(aes(y=tv,group=1),stat="identity",fill=gCol1[3]) +
    geom_line(aes(y=web),color=gCol1[1],size=2) +
    labs(x=gLabel[1],y=gLabel[2],title=gLabel[3],fill=gLabel[4])






